from torch import *
def M(parms, q, tgt_device='cuda'):
    # type: (Tensor, Tensor, str) -> Tensor
    M_out = zeros((q.shape[0],36), device=tgt_device)

    x0 = cos(q[:,1])
    x1 = sin(q[:,1])
    x2 = x0*(-1.15*x0**2 - 1.15*x1**2)
    x3 = x2 - 0.35
    x4 = sin(q[:,2])
    x5 = -x4
    x6 = x0*x5
    x7 = cos(q[:,2])
    x8 = 0.041*x4**2 + 0.041*x7**2
    x9 = x1*x7
    x10 = -x9
    x11 = -x3
    x12 = x10*x8 + x11 + x6*x8
    x13 = x10 + x6
    x14 = -x13
    x15 = x0*x7 + x1*x5
    x16 = cos(q[:,3])
    x17 = x15*x16
    x18 = -parms[52]
    x19 = sin(q[:,4])
    x20 = cos(q[:,4])
    x21 = x13*x19 + x17*x20
    x22 = -x12
    x23 = -x17
    x24 = -0.189*x0
    x25 = 0.189*x1
    x26 = x24*x4 + x24*x5 + x25*x7 - 0.189*x9
    x27 = sin(q[:,3])
    x28 = x16*x22 + x23 + x26*x27
    x29 = -x28
    x30 = sin(q[:,5])
    x31 = x15*x27
    x32 = x12*x27 + x16*x26 + x31
    x33 = x24*x7
    x34 = x25*x4 + x25*x5
    x35 = x19*x34 + x20*x32
    x36 = cos(q[:,5])
    x37 = x21*x30
    x38 = -x31
    x39 = x36*x38
    x40 = x29*x30 + x35*x36 + 0.24*x37 - 0.24*x39
    x41 = x37 - x39
    x42 = -parms[62]
    x43 = x13*x20 + x19*x23
    x44 = -x43
    x45 = parms[63]*x41 + parms[64]*x40 + x42*x44
    x46 = x30*x45
    x47 = -x29
    x48 = x30*x38
    x49 = x21*x36
    x50 = x30*x35 + x36*x47 - 0.24*x48 - 0.24*x49
    x51 = -parms[63]
    x52 = x48 + x49
    x53 = parms[61]*x44 + parms[64]*x50 + x51*x52
    x54 = -x36
    x55 = parms[39]*x14 + parms[40]*x17 + parms[42]*x28 - parms[50]*x43 - parms[53]*x29 - x18*x21 - x46 - x53*x54
    x56 = -x16
    x57 = x30*x53
    x58 = parms[51]*x44 + parms[52]*x38 + parms[53]*x35 + x36*x45 + x57
    x59 = -parms[50]
    x60 = -x19
    x61 = x20*x34 + x32*x60
    x62 = -parms[61]
    x63 = -x61
    x64 = parms[51]*x21 + parms[53]*x61 - parms[62]*x52 - parms[64]*x63 + x38*x59 - x41*x62
    x65 = parms[40]*x38 + parms[41]*x13 + parms[42]*x32 + x20*x58 + x60*x64
    x66 = x27*x65 + x55*x56
    x67 = -parms[30]
    x68 = parms[28]*x13 + parms[31]*x12 + x15*x67 + x66
    x69 = -parms[17]*x0 + parms[18]*x1 + parms[20]*x3 - x68
    x70 = -parms[19]
    x71 = x27*x55
    x72 = parms[29]*x14 + parms[31]*x26 + x16*x65 + x71
    x73 = parms[29]*x15 + parms[31]*x34 + parms[39]*x31 + parms[41]*x23 + parms[42]*x34 + x19*x58 + x20*x64
    x74 = parms[20]*x25 + x1*x70 + x5*x73 + x7*x72
    x75 = -0.189*x72
    x76 = -x34
    x77 = parms[55]*x52 + parms[56]*x41 + parms[57]*x44 + parms[62]*x63 + x50*x51
    x78 = -0.24*x36
    x79 = parms[56]*x52 + parms[58]*x41 + parms[59]*x44 + parms[63]*x40 + x62*x63
    x80 = parms[44]*x21 + parms[45]*x38 + parms[46]*x43 + parms[51]*x61 + parms[52]*x47 + x30*x79 + x36*x77 + 0.24*x46 + x53*x78
    x81 = -parms[57]*x52 - parms[59]*x41 - parms[60]*x44 - parms[61]*x50 - x40*x42
    x82 = -parms[51]
    x83 = parms[46]*x21 + parms[48]*x38 + parms[49]*x43 + parms[50]*x29 + x35*x82 + x81
    x84 = parms[33]*x17 + parms[34]*x13 + parms[35]*x31 + parms[40]*x28 + parms[41]*x76 + x20*x80 + x60*x83
    x85 = -parms[45]*x21 - parms[47]*x38 - parms[48]*x43 - parms[50]*x63 - parms[52]*x35 - x30*x77 - x45*x78 - x54*x79 + 0.24*x57
    x86 = -parms[40]
    x87 = parms[35]*x17 + parms[37]*x13 + parms[38]*x31 + parms[39]*x34 + x32*x86 + x85
    x88 = parms[22]*x15 + parms[24]*x13 + parms[29]*x34 + parms[30]*x22 + x16*x84 + x27*x87 + x66
    x89 = x68*x8
    x90 = parms[34]*x17 + parms[36]*x13 + parms[37]*x31 + parms[39]*x29 + parms[41]*x32 + x19*x80 + x20*x83
    x91 = parms[24]*x15 + parms[27]*x13 + parms[28]*x12 - parms[29]*x26 + x90
    x92 = -x7
    x93 = -parms[23]*x15 - parms[26]*x13 - parms[28]*x76 - parms[30]*x26 - x27*x84 - x56*x65 - x56*x87 + x71
    x94 = parms[13]*x1 + parms[15]*x0 + parms[17]*x25 - parms[18]*x24 + x73*x8 + 1.15*x74 + x93
    x95 = 0.041*x73 + x93
    x96 = -1.15*x4 + x8
    x97 = -x27
    x98 = x20*x97
    x99 = parms[51]*x98 + x56*x59
    x100 = 1.15*x7
    x101 = x100*x16 + x16
    x102 = x101*x60 + x20*x96
    x103 = -x102
    x104 = x30*x98
    x105 = x104 + x54*x56
    x106 = x30*x56
    x107 = x106 + x36*x98
    x108 = parms[62]*x107 + x105*x62
    x109 = parms[53]*x102 - parms[64]*x103 - x108 + x99
    x110 = -parms[41]
    x111 = parms[39]*x16 + x110*x97
    x112 = x60*x97
    x113 = -x112
    x114 = parms[61]*x113 + x107*x51
    x115 = -0.24*x106 + x78*x98
    x116 = x100*x27 + x27
    x117 = -x116
    x118 = x101*x20 + x19*x96
    x119 = x115 + x117*x54 + x118*x30
    x120 = parms[64]*x119 + x114
    x121 = x120*x30
    x122 = 0.24*x104 + x56*x78
    x123 = x117*x30 + x118*x36 + x122
    x124 = parms[63]*x105 + x113*x42
    x125 = parms[64]*x123 + x124
    x126 = parms[51]*x113 + parms[52]*x56
    x127 = parms[53]*x118 + x121 + x125*x36 + x126
    x128 = parms[28] + parms[31]*x96 + parms[42]*x96 + x109*x20 + x111 + x127*x19
    x129 = parms[40]*x56
    x130 = parms[42]*x101 + x109*x60 + x127*x20 + x129
    x131 = parms[56]*x107 + parms[58]*x105 + parms[59]*x113
    x132 = parms[63]*x123 + x103*x62 + x131
    x133 = parms[45]*x98 + parms[47]*x56 + parms[48]*x112
    x134 = parms[55]*x107 + parms[56]*x105 + parms[57]*x113
    x135 = parms[62]*x103 + x119*x51 + x134
    x136 = -parms[50]*x103 - parms[52]*x118 + 0.24*x121 - x125*x78 - x132*x54 - x133 - x135*x30
    x137 = parms[35]*x97 + parms[38]*x16
    x138 = -parms[25]
    x139 = parms[46]*x98 + parms[48]*x56 + parms[49]*x112
    x140 = parms[57]*x107 + parms[59]*x105 + parms[60]*x113
    x141 = -parms[61]*x119 - x123*x42 - x140
    x142 = parms[50]*x117 + x118*x82 + x139 + x141
    x143 = parms[44]*x98 + parms[45]*x56 + parms[46]*x112
    x144 = x125*x30
    x145 = parms[51]*x102 + x117*x18 + x120*x78 + x132*x30 + x135*x36 + x143 + 0.24*x144
    x146 = parms[33]*x97 + parms[35]*x16
    x147 = parms[40]*x97
    x148 = parms[50]*x112 + x18*x98
    x149 = parms[42]*x116 - parms[53]*x117 - x120*x54 - x144 + x147 - x148
    x150 = parms[28]*x96 - parms[30]*x100 - x130*x56 - x138 - x149*x97 - x27*(parms[40]*x116 + x110*x96 + x142*x60 + x145*x20 + x146) - x56*(parms[39]*x96 + x101*x86 + x136 + x137)
    x151 = 0.041*x128 + x150
    x152 = parms[34]*x97 + parms[37]*x16
    x153 = parms[39]*x117 + parms[41]*x101 + x142*x20 + x145*x19 + x152
    x154 = x16*x60 + 0.041*x20
    x155 = -x154
    x156 = parms[53]*x154 - parms[64]*x155 - x108 + x99
    x157 = x16*x20 + 0.041*x19
    x158 = x122 + x157*x36 + x30*x97
    x159 = parms[64]*x158 + x124
    x160 = x115 + x157*x30 + x54*x97
    x161 = parms[64]*x160 + x114
    x162 = x161*x30
    x163 = parms[53]*x157 + x126 + x159*x36 + x162
    x164 = parms[63]*x158 + x131 + x155*x62
    x165 = parms[62]*x155 + x134 + x160*x51
    x166 = -parms[52]*x157 - x133 - x154*x59 - x159*x78 + 0.24*x162 - x164*x54 - x165*x30
    x167 = x159*x30
    x168 = parms[51]*x154 + x143 + x161*x78 + x164*x30 + x165*x36 + 0.24*x167 + x18*x97
    x169 = -parms[61]*x160 - x140 - x158*x42
    x170 = parms[50]*x97 + x139 + x157*x82 + x169
    x171 = parms[39]*x97 + parms[41]*x16 + x152 + x168*x19 + x170*x20
    x172 = x19*x78
    x173 = x19*x30
    x174 = 0.24*x173
    x175 = -x20
    x176 = x19*x36
    x177 = -parms[57]*x176 - parms[59]*x173 - parms[60]*x175 - parms[61]*x172 - x174*x42
    x178 = parms[56]*x176 + parms[58]*x173 + parms[59]*x175 + parms[63]*x174
    x179 = parms[55]*x176 + parms[56]*x173 + parms[57]*x175 + x172*x51
    x180 = parms[61]*x175 + parms[64]*x172 + x176*x51
    x181 = parms[63]*x173 + parms[64]*x174 + x175*x42
    x182 = -parms[45]*x19 - parms[48]*x20 - x178*x54 - x179*x30 + 0.24*x180*x30 - x181*x78
    x183 = 0.24*x30
    x184 = -x30
    x185 = 0.24*x36
    x186 = -parms[57]*x184 - parms[59]*x36 - parms[61]*x183 - x185*x42
#
    M_out[:,0] = parms[10] + parms[3] + 0.7*parms[6] + 0.1225*parms[9] + x0*(parms[12]*x1 + parms[14]*x0 + parms[17]*x11 + parms[19]*x24 + x4*x75 + x5*x89 + x5*x91 - 0.189*x7*x73 + x7*x88) + x1*(parms[11]*x1 + parms[12]*x0 + parms[18]*x3 + x25*x70 + 0.189*x4*x73 + x5*x88 + x7*x75 + x89*x92 + x91*x92) + x2*x69 + x24*(parms[19]*x0 + parms[20]*x24 + x5*x72 + x73*x92) + x25*x74 - 0.35*x69
    M_out[:,1] = x94
    M_out[:,2] = x95
    M_out[:,3] = x90
    M_out[:,4] = x85
    M_out[:,5] = x81
    M_out[:,6] = x94
    M_out[:,7] = parms[16] + 2.3*parms[17] + 1.3225*parms[20] + parms[21] + 1.15*x128*x5 + x128*x8 + x150 + 1.15*x7*(parms[31]*x100 + x130*x16 + x149*x27 + x67)
    M_out[:,8] = x151
    M_out[:,9] = x153
    M_out[:,10] = x136
    M_out[:,11] = x141
    M_out[:,12] = x95
    M_out[:,13] = x151
    M_out[:,14] = 0.082*parms[28] + 0.001681*parms[31] + parms[32] + 0.001681*parms[42] + 0.041*x111 - x138 + 0.041*x156*x20 + 0.041*x163*x19 - x27*(parms[40]*x27 - 0.041*parms[41] + x146 + x168*x20 + x170*x60) - x56*(0.041*parms[39] + x129 + x137 + x166) - x56*(parms[42]*x16 + x129 + x156*x60 + x163*x20) - x97*(parms[42]*x27 - parms[53]*x97 + x147 - x148 - x161*x54 - x167)
    M_out[:,15] = x171
    M_out[:,16] = x166
    M_out[:,17] = x169
    M_out[:,18] = x90
    M_out[:,19] = x153
    M_out[:,20] = x171
    M_out[:,21] = parms[36] + parms[43] + x19*(parms[44]*x19 + parms[46]*x20 + x178*x30 + x179*x36 + x180*x78 + 0.24*x181*x30) + x20*(parms[46]*x19 + parms[49]*x20 + x177)
    M_out[:,22] = x182
    M_out[:,23] = x177
    M_out[:,24] = x85
    M_out[:,25] = x136
    M_out[:,26] = x166
    M_out[:,27] = x182
    M_out[:,28] = parms[47] + parms[54] + 0.24*x30*(parms[64]*x183 + x184*x51) - x30*(parms[55]*x184 + parms[56]*x36 + x183*x51) - x54*(parms[56]*x184 + parms[58]*x36 + parms[63]*x185) - x78*(parms[63]*x36 + parms[64]*x185)
    M_out[:,29] = x186
    M_out[:,30] = x81
    M_out[:,31] = x141
    M_out[:,32] = x169
    M_out[:,33] = x177
    M_out[:,34] = x186
    M_out[:,35] = parms[60] + parms[65]
#
    return M_out